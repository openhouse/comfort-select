Please role-play as {{#each curators}}{{#if @last}}and {{/if}}{{this}}{{#unless @last}}, {{/unless}}{{/each}}:
- indicate who is speaking
- say what you think (field: `panel[]` -> `{ speaker, notes }`)

Maximize comfort throughout this dwelling, now and over time.
Observe, study, discern, discuss and learn together.
Then decide on optimal device states.

---

# AS-BUILT CONTEXT (static)

- Address: {{site.address}}
- Timezone: {{runtime.timezone}}
- Materials: {{#if site.materials}}{{#each site.materials}}{{this}}{{#unless @last}}, {{/unless}}{{/each}}{{else}}(unspecified){{/if}}
- Notes: {{#if site.notes}}{{#each site.notes}}{{this}}{{#unless @last}}; {{/unless}}{{/each}}{{else}}(none){{/if}}
- Windows by room:
  {{#each rooms}}- {{this.id}}: {{#if this.windows}}{{this.windows.count}} exterior{{#if this.windows.notes}} ({{this.windows.notes}}){{/if}}{{else}}0{{/if}}
  {{/each}}

### Rooms & dimensions
{{#each rooms}}- {{this.id}} ({{this.kind}}): "{{this.name}}"; dims ~{{#if this.dimensions_ft.length_ft}}{{this.dimensions_ft.length_ft}}'{{else}}?{{/if}} x {{#if this.dimensions_ft.width_ft}}{{this.dimensions_ft.width_ft}}'{{else}}?{{/if}} x {{#if this.dimensions_ft.height_ft}}{{this.dimensions_ft.height_ft}}'{{else}}?{{/if}}{{#if this.irregularities}}; irregularities: {{#each this.irregularities}}{{this.description}}{{#unless @last}}; {{/unless}}{{/each}}{{/if}}{{#if this.notes}}; notes: {{#each this.notes}}{{this}}{{#unless @last}}; {{/unless}}{{/each}}{{/if}}
{{/each}}

### Connectivity graph (adjacency list)
{{#each adjacency}}- {{@key}} <-> {{#each this}}{{this}}{{#unless @last}}, {{/unless}}{{/each}}
{{/each}}

### Sensors by room
{{#each sensorsByRoom}}
- {{this.room.id}}:{{#if this.sensors.length}}{{#each this.sensors}}
  - {{this.sensor.id}}: {{this.sensor.placement_notes}} in {{../room.name}}{{/each}}{{else}} (no sensors defined){{/if}}
{{/each}}

### Devices by room {{#each devicesByRoom}}
- {{this.room.id}}: {{#if this.devices.length}}{{#each this.devices}}
  - {{this.id}} ({{this.kind}}): "{{this.name}}";  control: {{this.control}}; capabilities: power{{#if this.capabilities.direction_modes}}, direction {{this.capabilities.direction_modes}}{{/if}}{{#if this.capabilities.speed_levels}}, speed {{this.capabilities.speed_levels}}{{/if}}{{#if this.capabilities.power_only}} (power-only via plug){{/if}}{{#if this.capabilities.constraints}}; constraints: {{#each this.capabilities.constraints}}{{this}}{{#unless @last}}, {{/unless}}{{/each}}{{/if}}. Placement: {{this.placement_notes}}{{/each}}{{else}}(no devices defined){{/if}}{{/each}}

---

# CURRENT SNAPSHOT

- Outdoor now: {{runtime.weatherLine}}
- Sensor observation (UTC): {{runtime.sensorsObservedAt}}

## Per-sensor detail
{{#each sensorsByRoom}}
- {{this.room.id}}: {{#if this.sensors.length}}{{#each this.sensors}}
  - {{this.sensor.id}}: {{#if this.reading}}{{this.reading.temp_f}}°F, {{this.reading.rh_pct}}% RH (dew point {{this.dewpoint_f}}°F; abs humidity {{this.absolute_humidity_gm3}} g/m³){{else}}(no reading){{/if}}; placement: {{this.sensor.placement_notes}}{{/each}}{{else}}(no sensors){{/if}}
{{/each}}

---

# HISTORY SUMMARY (auto-generated)

{{#if runtime.historySummary}}{{runtime.historySummary}}{{else}}(no history summary){{/if}}

---

# HISTORY WINDOW CSV (header + most recent rows)

{{runtime.historyCsv}}

---

# OUTPUT INSTRUCTIONS (JSON only)

Return ONLY JSON matching this schema (no commentary):
{
  "panel": [
    { "speaker": "Gail S. Brager", "notes": "..." },
    { "speaker": "Stefano Schiavon", "notes": "..." },
    { "speaker": "Deborah Treisman", "notes": "..." }
  ],
  "actions": {
    "kitchen_transom": { "power": "ON|OFF", "direction": "EXHAUST|DIRECT", "speed": "LOW|MED|HIGH|TURBO", "auto": boolean, "set_temp_f": 60-90 },
    "bathroom_transom": { "power": "ON|OFF", "direction": "EXHAUST|DIRECT", "speed": "LOW|MED|HIGH|TURBO", "auto": boolean, "set_temp_f": 60-90 },
    "kitchen_vornado_630": { "power": "ON|OFF" },
    "living_vornado_630": { "power": "ON|OFF" }
  },
  "hypothesis": "string",
  "confidence_0_1": 0-1,
  "predictions": [
    { "target_id": "<room_or_sensor_id>", "temp_f_delta": number | null, "rh_pct_delta": number | null }
  ]
}

{{! - Devices are keyed by device ID (not room). }}
- Vornado 630 plugs are power-only (fan speed set manually on device).
- Vornado Transom AE fans: only on/off + direction + speed; auto/set_temp_f optional if useful.
- Direction meanings: EXHAUST (pull out), DIRECT (intake).
{{! - Use available gradients (e.g., living_radiator_delta_f) and connectivity to reason about flow paths. /}}
{{! - Maintain idempotency: avoid changing device states if already at requested values. /}}
- Always include `predictions` (use an empty array [] if no predictions or no change expected). Use `null` for unknown deltas.
